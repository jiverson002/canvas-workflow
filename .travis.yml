# Tell Travis the project language.
language: ruby

# Route to the container-based infrastructure for a faster build.
sudo: false

# Enable caching the bundle between builds.
cache: bundler

# Branch whitelist.
branches:
  only:
    - master
    - doc

# The order of the steps below is significant.
script:
  # initialize environment
  - EXITCODE=0 ; (exit $EXITCODE)
  # run RSpec tests
  - test $EXITCODE -eq 0 && bundle exec rspec ; EXITCODE=$? ; (exit $EXITCODE)
  # upload files to canvas
  - test $EXITCODE -eq 0 && bundle exec canvas-upload ; EXITCODE=$? ; (exit $EXITCODE)
  # build site
  - test $EXITCODE -eq 0 && bundle exec jekyll build --verbose ; EXITCODE=$? ; (exit $EXITCODE)
  # deploy site to canvas
  - test $EXITCODE -eq 0 && bundle exec canvas-deploy ; EXITCODE=$? ; (exit $EXITCODE)
