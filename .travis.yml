# Tell Travis the project language.
language: ruby

# Route to the container-based infrastructure for a faster build.
sudo: false

# Enable caching the bundle between builds.
cache: bundler

# Branch whitelist.
branches:
  only:
    - master

# The stages of testing, building, and deploying the Canvas Workflow site.
jobs:
  include:
    - # run RSpec tests
      stage: test
      script: bundle exec rspec
      if: branch = master
    - # push files to canvas
      stage: push
      script: bundle exec canvas sync
      if: branch = master
    - # build site
      stage: build
      script: bundle exec jekyll build --verbose
      if: branch = master
    - # deploy site to canvas
      stage: deploy
      script: bundle exec canvas deploy
      if: branch = master
