# Tell Travis the project language.
language: ruby

# Route to the container-based infrastructure for a faster build.
sudo: false

# Install the required Ruby Gems --- this location is preferred over a Gemfile,
# so that repo does not require an additional config file.
install:
  - gem install 'canvas-workflow-jekyll' -v '= 0.3.0'
  - gem install 'canvas-workflow-travis' -v '= 0.9.0'

# The order of the steps below is significant.
script:
  # initialize environment
  - EXITCODE=0 ; (exit $EXITCODE)
  # upload files to canvas
  - test $EXITCODE -eq 0 && canvas sync ; EXITCODE=$? ; (exit $EXITCODE)
  # build site
  - test $EXITCODE -eq 0 && jekyll build --verbose ; EXITCODE=$? ; (exit $EXITCODE)
  # deploy site to canvas
  - test $EXITCODE -eq 0 && canvas deploy ; EXITCODE=$? ; (exit $EXITCODE)
